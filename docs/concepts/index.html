<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="Permissions-Policy" content="interest-cohort=()"/><link rel="icon" href="/core/favicon.ico"/><title>@magic/core documentation</title><meta name="twitter:image" property="og:image" content="https:/magic.github.io/core/logo.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="description" content="@magic/core conceptual information. explains the main concepts that make the @magic work."/><meta name="author" content="Jascha Ehrenreich"/><script type="application/ld+json">{"@context":"http://schema.org","@type":"website","name":"@magic/core documentation","url":"https://magic.github.io/core/","about":"@magic framework core.","image":"https:/magic.github.io/core/logo.png","author":{"@type":"person","name":"Jascha Ehrenreich","jobTitle":"Technomancer","image":"https:/jaeh.at/img/jascha.ehrenreich.jpg","url":"https://jaeh.at"}}</script><link rel="stylesheet" href="/core/magic.css?RMlV7mx68W" integrity="sha384-RMlV7mx68WWnpMsiF4hfZxKYt4B/fc1CkUjUZJiwUb/Qu8GcrtzKBN7JlP/o9FDS" crossorigin="anonymous"/></head><body><a class="SkipLink" href="/core/#page">Skip to Content</a><main id="Magic"><div class="Wrapper"><header class="Header"><a class="Logo" href="/core/"><svg viewBox="0 0 512 444"><path d="M512 444L256 0 0 444z" fill="#663695"></path><circle cx="256" cy="294" r="130" fill="#fff"></circle><circle cx="256" cy="281" r="40" fill="#663695"></circle><path d="M256 350v44m24-44l1 13c1 27 29 27 29-7m-160-72s46-47 106-47c59 0 106 47 106 47s-47 43-106 43c-60 0-106-43-106-43zm65-75a134 134 0 0189 2" class="stroke"></path><path d="M256 81v53m184 270l-43-29M72 404l43-29" class="stroke white"></path></svg></a><p>@magic</p><nav class="Menu"><ul><li class="active"><a href="/core/concepts/">concepts</a><ul><li><a href="/core/concepts/#modules">modules</a></li><li><a href="/core/concepts/#state">state</a></li><li><a href="/core/concepts/#actions">actions</a></li><li><a href="/core/concepts/#views">views</a></li><li><a href="/core/concepts/#styles">styles</a></li><li><a href="/core/concepts/#globals">global</a></li><li><a href="/core/concepts/#lambdas">server lambdas</a></li></ul></li><li><a href="/core/files/">files &amp; directories</a></li><li><a href="/core/modules/">modules</a></li><li><a href="/core/themes/">themes</a></li><li><a href="/core/libraries/">libraries</a></li><li><a href="/core/news/">news</a></li><li><a href="/core/test/">test</a></li></ul></nav></header><div class="Page" id="page"><h1 id="magiccore-concepts">@magic/core concepts</h1><p>magic concepts. These are the building blocks of every module in a magic app</p><h2 id="modules">@magic-modules</h2><p>modules are the main building block of magic.</p><p>a page is a module, a button is a module, a link is a module, an image is a module.
even a theme is a module.</p><p>a @magic app contains modules containing modules that contain modules.
this can lead to inception.</p><h2 id="module-building-blocks">module building blocks</h2><h3 id="state">state</h3><p>state is a javascript object.
state can be mutated by actions, 
effects and subscriptions can call actions to change the state.
every rendering frame, the state determines the output of the html views.</p><div class="Pre lines"><div class="menu"><button>copy</button></div><pre><code class="line"><span class="keyword">const</span> <span class="state">state</span> = {</code><code class="line">  shown: false,</code><code class="line">  count: 0,</code><code class="line">}</code></pre></div><h2 id="actions">actions</h2><p>actions are an object containing functions</p><p>those functions get the state and their props and may return a new full, but changed, state.</p><div class="Pre lines"><div class="menu"><button>copy</button></div><pre><code class="line"><span class="keyword">const</span> <span class="actions">actions</span> = {</code><code class="line">  toggleModal: <span class="state">state</span> <span class="keyword">=&gt;</span> {</code><code class="line">    <span class="keyword">return</span> {</code><code class="line">      ...state,</code><code class="line">      shown: !state.shown,</code><code class="line">    }</code><code class="line">  },</code><code class="line"></code><code class="line">  calculator: {</code><code class="line">    plus: <span class="state">state</span> <span class="keyword">=&gt;</span> ({ ...state, count: state.count + 1 }),</code><code class="line">    minus: <span class="state">state</span> <span class="keyword">=&gt;</span> ({ ...state, count: state.count - 1 }),</code><code class="line">  },</code><code class="line">}</code></pre></div><h2 id="effects">effects</h2><p>effects are an object containing functions, just like actions.</p><p>effects can only change the state by calling actions.</p><p>effects may also be impure and trigger side-effects outside of hyperapp.</p><div class="Pre lines"><div class="menu"><button>copy</button></div><pre><code class="line"><span class="keyword">const</span> effects = {</code><code class="line">  waitASec: [state, <span class="keyword">async</span> <span class="state">state</span> <span class="keyword">=&gt;</span> {</code><code class="line">    <span class="keyword">await</span> <span class="keyword">new</span> Promise((r) <span class="keyword">=&gt;</span> setTimeout(r, 1000))</code><code class="line"></code><code class="line">    <span class="keyword">return</span> actions.plus(state)</code><code class="line">  }],</code><code class="line">}</code></pre></div><h2 id="subscriptions">subscriptions</h2><p>at the moment, subscriptions can be defined using strings as function names.</p><p>also, if a module exports a subscriptions array, those subscriptions will be added to the app.</p><div class="Pre lines"><div class="menu"><button>copy</button></div><pre><code class="line"><span class="keyword">const</span> subscriptions = {</code><code class="line">  subscribe: (dispatch, action) <span class="keyword">=&gt;</span> {</code><code class="line">    setInterval(() <span class="keyword">=&gt;</span> {</code><code class="line">      dispatch(action, { arg: Math.random() * 100 })</code><code class="line">    })</code><code class="line">  },</code><code class="line">}</code><code class="line"></code><code class="line"><span class="keyword">const</span> <span class="actions">actions</span> = {</code><code class="line">  onSubscription: (state, e) <span class="keyword">=&gt;</span> ({</code><code class="line">    ...state,</code><code class="line">    arg: e.arg,</code><code class="line">  })</code><code class="line">}</code><code class="line"></code><code class="line"><span class="keyword">export</span> <span class="keyword">const</span> subscriptions = [<span class="string">&#39;subscriptions.subscribe&#39;</span>, <span class="string">&#39;actions.onSubscription&#39;</span>]</code></pre></div><h2 id="views">views</h2><p>views render the state to html
whenever an action triggers a change in the state, this then triggers a view change.</p><div class="Pre lines"><div class="menu"><button>copy</button></div><pre><code class="line"><span class="keyword">export</span> <span class="keyword">const</span> View = <span class="state">state</span> <span class="keyword">=&gt;</span> div(JSON.stringify(state))</code></pre></div><h2 id="styles">styles</h2><p>every module can export a style object.
magic will automagically merge all styles into one global css file.
in the future, it will also remove unused styles for you.</p><p>styles merge order, last overwrites first:
module.style &lt; page.style &lt; app.style &lt; theme.style</p><p>this allows css to be inherited in both directions.</p><p>a module automatically creates it&#39;s own css namespace,
that same namespace can be used in page, app and theme css styles 
to overwrite module specific styles.</p><h3 id="styles-magiccss">@magic/css</h3><p>internally, magic uses it&#39;s own css-in-js library.</p><p>to find out more, click the following link:
<a href="https://magic.github.io/css/" target="_blank" rel="noopener">@magic/css</a></p><h2 id="globals">globals</h2><p>every module can set a global object, containing state and action properties.</p><p>every state and/or action name in the global object with a value that equals true gets merged into the main app state/actions, instead of into the module namespace.</p><div class="Pre lines"><div class="menu"><button>copy</button></div><pre><code class="line"><span class="comment">// <span class="keyword">in</span> module.mjs</span></code><code class="line"></code><code class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="state">state</span> = {</code><code class="line">  internal: 0,</code><code class="line">  external: 0,</code><code class="line">}</code><code class="line"></code><code class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="actions">actions</span> = {</code><code class="line">  internal: <span class="state">state</span> <span class="keyword">=&gt;</span> ({</code><code class="line">    ...state,</code><code class="line">    module: {</code><code class="line">      internal: state.module.interal + 1,</code><code class="line">    },</code><code class="line">  }),</code><code class="line">  external: <span class="state">state</span> <span class="keyword">=&gt;</span> ({</code><code class="line">    ...state,</code><code class="line">    external: state.external + 1,</code><code class="line">  }),</code><code class="line">}</code><code class="line"></code><code class="line"><span class="keyword">export</span> <span class="keyword">const</span> global = {</code><code class="line">  state: {</code><code class="line">    external: <span class="boolean">true</span></code><code class="line">  },</code><code class="line">  actions: {</code><code class="line">    external: true,</code><code class="line">  },</code><code class="line">}</code><code class="line"></code><code class="line"><span class="comment">// <span class="keyword">in</span> the view, we can use both the global and local <span class="actions">actions</span> and <span class="state">state</span> variables</span></code><code class="line"></code><code class="line"><span class="keyword">export</span> <span class="keyword">const</span> View = <span class="state">state</span> <span class="keyword">=&gt;</span> div([</code><code class="line">  <span class="string">&#39;view&#39;</span>,</code><code class="line">  p({ onclick: actions.module.internal }, [<span class="string">&#39;internal:&#39;</span>, state.module.internal]),</code><code class="line">  p({ onclick: actions.external }, [<span class="string">&#39;external:&#39;</span>, state.external]),</code><code class="line">])</code></pre></div><h2 id="lambdas">server lambdas</h2><p>this is the serverside magic.
you can define functions that get transpiled into serverside lambdas.
server side lambdas will be available for GET and/or POST requests.</p><p>the server side function signature is (req, res) =&gt; {},
as it is in most nodejs http servers,
with the addition of req.body being async =&gt; awaited before execution of the lambda.</p></div><footer class="Footer"><div class="Container"><div class="Credits">made with a few bits of <a target="_blank" rel="noopener" href="https://magic.github.io/">magic</a></div></div></footer></div></main><script src="/core/magic.js?3NoXxRp8FD" integrity="sha384-3NoXxRp8FDwYmyaNd+5x9o2INJ/xrod7w3+9HXgOl0q0zPoH8jjSna9gv6mQd6HC" crossorigin="anonymous"></script></body></html>